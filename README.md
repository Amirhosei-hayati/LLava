# سیستم تشخیص و توصیف کالا با LLaVA

این مخزن شامل یک نمونه‌ی عملی برای ساخت اپلیکیشن تحت وب جهت تشخیص و توصیف کالا از روی تصویر با استفاده از مدل چندوجهی **LLaVA** است. خروجی اپ به صورت متنی شامل نوع کالا، رنگ و جنس ظاهری، کاربرد احتمالی و دسته‌بندی پیشنهادی جهت درج در فروشگاه آنلاین خواهد بود.

## قابلیت‌ها
- بارگذاری تصویر محصول و دریافت پاسخ توصیفی خودکار.
- امکان سفارشی‌سازی سؤال جهت استخراج اطلاعات جزئی‌تر.
- تنظیمات دما، Top-p و حداکثر تعداد توکن‌های خروجی برای کنترل خلاقیت مدل.
- پیاده‌سازی با کتابخانه‌های متن‌باز: `transformers`, `torch`, `gradio`, `Pillow`.

## ساختار پروژه
```
.
├── app.py                  # اپلیکیشن Gradio برای اجرا در لوکال یا Colab
├── requirements.txt        # وابستگی‌های پایتونی مورد نیاز
├── notebooks/
│   └── llava_product_demo.ipynb  # نوت‌بوک نمونه جهت اجرا در Google Colab
└── README.md
```

## پیش‌نیازها
- Python 3.9 یا جدیدتر
- کارت گرافیک با حافظه حداقل 16GB (به دلیل حجم بالای مدل 7B). اجرای CPU تنها برای تست و بدون تضمین سرعت مناسب است.
- دسترسی به اینترنت برای دانلود مدل از Hugging Face

## راهنمای اجرای سریع
### 1. کلون کردن مخزن و ساخت محیط مجازی
```bash
git clone https://github.com/<YOUR_USERNAME>/LLava.git
cd LLava
python -m venv .venv
source .venv/bin/activate  # در ویندوز: .venv\\Scripts\\activate
```

### 2. نصب پیش‌نیازها
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 3. ورود به Hugging Face (در صورت نیاز)
مدل `llava-hf/llava-1.5-7b-hf` روی Hugging Face میزبانی می‌شود. اگر پیش‌تر شرایط استفاده را نپذیرفته‌اید یا نیاز به توکن خصوصی دارید، ابتدا در [صفحه مدل](https://huggingface.co/llava-hf/llava-1.5-7b-hf) آن را تایید کنید و سپس در ترمینال وارد شوید:
```bash
huggingface-cli login
```
یا متغیر محیطی زیر را ست کنید:
```bash
export HUGGING_FACE_HUB_TOKEN=<YOUR_TOKEN>
```

### 4. اجرای اپلیکیشن Gradio
```bash
python app.py
```
پس از اجرای اسکریپت، لینک Gradio در ترمینال نمایش داده می‌شود (به صورت `http://127.0.0.1:7860`). آن را در مرورگر باز کنید، تصویر محصول را آپلود کرده و نتیجه را ببینید.

> **نکته:** برای اشتراک‌گذاری روی شبکه محلی یا اینترنت (مثلاً در Colab) می‌توانید از گزینه `--share` استفاده کنید:
> ```bash
> python app.py --share
> ```
> همچنین می‌توانید با گزینه‌های `--server-name` و `--server-port` پورت و آدرس دلخواه را مشخص کنید.

### اجرای بهینه‌سازی‌شده
برای استفاده از حالت 8-بیتی (کاهش مصرف حافظه) باید بستهٔ `bitsandbytes` را نصب کرده و سپس متغیر محیطی زیر را قبل از اجرا تنظیم کنید. توجه داشته باشید که این حالت همچنان به GPU نیاز دارد.
```bash
pip install bitsandbytes
export LLAVA_USE_8BIT=1
```

## اجرا در Google Colab
1. نوت‌بوک `notebooks/llava_product_demo.ipynb` را در Colab باز کنید.
2. همه‌ی سلول‌ها را به‌ترتیب اجرا کنید.
3. در انتها، لینک Gradio نمایش داده خواهد شد و می‌توانید اپ را مشابه نسخه‌ی محلی استفاده کنید.

## ایده‌هایی برای توسعه‌ی بیشتر
- ذخیره و مدیریت نتایج تحلیل در پایگاه داده.
- افزودن چندزبانه کردن پاسخ‌ها (مثلاً فارسی و انگلیسی).
- یکپارچه‌سازی با API فروشگاه برای ثبت خودکار محصولات.
- آموزش مجدد (Fine-tune) روی داده‌های اختصاصی فروشگاه برای دقت بالاتر.

## اسکرین‌شات
به محض اجرای اپ و گرفتن خروجی، می‌توانید با ابزارهایی مثل Snipping Tool یا ابزار Screenshot سیستم‌عامل خود عکس بگیرید و در مستندات داخلی یا صفحه‌ی محصول پروژه قرار دهید.

## مجوز
این پروژه تحت مجوز MIT منتشر شده است (مطابق فایل `LICENSE`).
